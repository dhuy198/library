
<div class="mb-[20px]">
  <span class="text-3xl font-bold mr-[15px]"> 
    <%= link_to "Thư viện", user_books_path%>
  </span>
  <span class="text-3xl font-bold"> 
    <%= link_to "Mượn sách", new_user_borrowing_path()%>
  </span>
</div>

<% if @borrowings.any? %>
    <div class="space-y-4">
        <% @borrowings.each do |borrowing| %>
        <div class="bg-white p-4 rounded-lg shadow-md">
            <p class="text-gray-700">Mã phiếu: <span class="font-semibold"><%= borrowing.id %></span></p>
            <p class="text-gray-700">
            Ngày mượn:
                <%= borrowing.start_at&.strftime('%d/%m/%Y') || "Chưa có" %>
            </p>

            <p class="text-gray-700">
                Hạn trả:
                <%= borrowing.end_at&.strftime('%d/%m/%Y') || "Chưa có" %>
            </p>

            <p class="text-gray-700">
                Thực trả:
                <%= borrowing.actual_end_at&.strftime('%d/%m/%Y') || "Chưa có" %>
            </p>


            <% if borrowing.borrowing_items.any? %>
                <div class="mt-3">
                    <p class="font-semibold text-gray-800">Sách đã mượn:</p>
                    <ul class="list-disc list-inside text-gray-600">
                    <% borrowing.borrowing_items.each do |item| %>
                        <li><%= item.book.title %> :  <%= item.quantity %> quyển</li>
                    <% end %>
                    </ul>
                </div>
            <% else %>
            <p class="text-sm text-red-500 mt-2">Chưa có sách nào trong phiếu.</p>
            <% end %>
        </div>
        <% if borrowing.actual_end_at.nil? %>
                <%= button_to "Trả sách", pay_user_borrowing_path(borrowing), method: :patch, data: { confirm: "Bạn chắc chắn muốn trả sách?" }, class: "mt-4 bg-blue-500 text-white px-4 py-2 rounded" %>
            <% end %>
        <% end %>

    </div>
<% else %>
  <p class="text-gray-500">Không có phiếu mượn nào.</p>
<% end %>
