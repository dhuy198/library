<div class="relative h-[60px] mb-[30px]">
  <%= button_to "Log out", destroy_admin_session_path, method: :delete,
      class: "absolute right-[20px] top-0 px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700" %>
</div>

<div class="max-w-[1400px] mx-auto">

  <div class="flex flex-wrap gap-6 items-center mb-6 bg-[#0b1a33] py-[20px] px-[40px] items-center justify-between">
    <%= link_to "Trang chủ", admin_books_path, class: "text-3xl font-bold text-white hover:underline underline-offset-[10px]" %> 
    <%= link_to "Danh sách người dùng", admin_users_path, class: "text-3xl font-bold text-white hover:underline hover:underline-offset-[10px]" %>
    <%= link_to "Danh sách phiếu mượn sách", admin_borrowings_path, class: "text-3xl font-bold text-white underline underline-offset-[10px]" %>
  </div>
  

<% if @borrowings.any? %>
  <div class="overflow-x-auto shadow-md rounded-lg border border-gray-200">
    <table class="min-w-full divide-y divide-gray-200 bg-white text-sm">
      <thead class="bg-gray-100 text-gray-700 uppercase font-semibold text-xs">
        <tr>
          <th class="px-6 py-3 text-left">ID</th>
          <th class="px-6 py-3 text-left">Người mượn</th>
          <th class="px-6 py-3 text-left">Ngày mượn</th>
          <th class="px-6 py-3 text-left">Ngày dự kiến trả</th>
          <th class="px-6 py-3 text-left">Ngày trả thực tế</th>
          <th class="px-6 py-3 text-left">Trạng thái</th>
        </tr>
      </thead>

      <tbody class="divide-y divide-gray-200 text-gray-800">
        <% @borrowings.each do |borrowing| %>
          <tr class="hover:bg-gray-50 transition duration-200 cursor-pointer" data-link="<%= admin_borrowing_path(borrowing)%>">
            
            <td class="px-6 py-4"><%= borrowing.id %></td>
            <td class="px-6 py-4">
                <span class="text-blue-700 font-medium"><%= borrowing.user.name %></span>
            </td>

            <td class="px-6 py-4"><%= borrowing.start_at.strftime("%d/%m/%Y") if borrowing.start_at %></td>
            <td class="px-6 py-4"><%= borrowing.end_at.strftime("%d/%m/%Y") if borrowing.end_at %></td>
            <td class="px-6 py-4">
              <% if borrowing.actual_end_at %>
                <%= borrowing.actual_end_at.strftime("%d/%m/%Y") %>
              <% else %>
                <span class="text-gray-500 italic">Chưa trả</span>
              <% end %>
            </td>

            <td class="px-6 py-4">
              <% if borrowing.actual_end_at %>
                <span class="inline-block px-2 py-1 bg-red-100 text-red-700 text-xs font-semibold rounded">Đã trả</span>
              <% else %>
                <span class="inline-block px-2 py-1 bg-green-100 text-green-700 text-xs font-semibold rounded">Chưa trả</span>
              <% end %>
            </td>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>
<% else %>
  <p class="text-gray-600 italic mt-4">Chưa có bản ghi mượn sách nào trong hệ thống.</p>
<% end %>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    document.querySelectorAll("tr[data-link]").forEach(function (row) {
      row.addEventListener("click", function () {
        window.location = row.getAttribute("data-link");
      });
    });
  });
</script>

